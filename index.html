<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Assistente Virtual - SEDAP</title>
</head>
<body>
  <h1>Assistente Virtual</h1>
  <p>Converse com nosso bot no canto da tela</p>

  <script src="https://sf-cdn.coze.com/obj/unpkg-va/flow-platform/chat-app-sdk/1.2.0-beta.6/libs/oversea/index.js"></script>
  <script>
    function getUniqueUserId() {
      try {
        let id = localStorage.getItem('cozeChatVisitorId');
        if (!id) {
          id = (crypto && crypto.randomUUID) ? crypto.randomUUID() : (Date.now() + '-' + Math.random().toString(16).slice(2));
          localStorage.setItem('cozeChatVisitorId', id);
        }
        return id;
      } catch (e) {
        // Fallback se localStorage estiver bloqueado
        return (Date.now() + '-' + Math.random().toString(16).slice(2));
      }
    }

    new CozeWebSDK.WebChatClient({
      config: {
        bot_id: '7570014364363751432',
      },
      componentProps: {
        title: 'Assistente SEDAP',
      },
      auth: {
        type: 'token',
        token: 'pat_nOMe2AdxZGxCYGUrqDJFt65jsuDN3PleNl7H1Pemqr823RkZ413uNqizVN0LQg3M',
        onRefreshToken: function () {
          return 'pat_nOMe2AdxZGxCYGUrqDJFt65jsuDN3PleNl7H1Pemqr823RkZ413uNqizVN0LQg3M';
        }
      },
      // ATENÇÃO: usar "user" (não "userInfo") para isolar as sessões
      user: {
        id: getUniqueUserId(),
        name: 'Visitante'
      }
    });
  </script>
</body>
</html>
