<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Simples de Chatbot</title>
    <style>
        /* CSS B√°sico incorporado */
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        h1 {
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>P√°gina de Teste do Chatbot</h1>
    <p style="text-align: center;">Se tudo estiver correto, um bal√£o de chat deve aparecer no canto inferior direito.</p>

    <!-- Script do Coze SDK -->
    <script src="https://sf-cdn.coze.com/obj/unpkg-va/flow-platform/chat-app-sdk/1.2.0-beta.6/libs/oversea/index.js"></script>
    
    <!-- Script de Inicializa√ß√£o Incorporado -->
    <script>
        // Espera a p√°gina carregar
        document.addEventListener('DOMContentLoaded', () => {
            console.log('P√°gina carregada, tentando iniciar o chatbot...');

            // Fun√ß√£o para gerar ID de usu√°rio √∫nico
            function generateUniqueUserId() {
                let userId = localStorage.getItem('coze_test_user_id');
                if (!userId) {
                    userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substring(2, 11);
                    localStorage.setItem('coze_test_user_id', userId);
                    console.log('Novo ID de usu√°rio gerado:', userId);
                }
                return userId;
            }

            try {
                // Tenta inicializar o WebChatClient
                new CozeWebSDK.WebChatClient({
                    config: {
                        bot_id: '7569740873408806930', // SUBSTITUA PELO SEU BOT_ID
                    },
                    auth: {
                        type: 'token',
                        token: 'pat_hcAUqeVd3kk8t8CuutNzfQKZu5b2duD1YogVbLCBScRSULNiIBTXpk8ozvntOQDk', // SUBSTITUA PELO SEU TOKEN
                        onRefreshToken: () => 'pat_hcAUqeVd3kk8t8CuutNzfQKZu5b2duD1YogVbLCBScRSULNiIBTXpk8ozvntOQDk'
                    },
                    userInfo: {
                        id: generateUniqueUserId() // Gera ID √∫nico para sess√£o isolada
                    },
                    ui: {
                        chatBot: {
                            title: 'Assistente de Teste'
                        }
                    },
                    onInit: () => {
                        console.log('‚úÖ SUCESSO: Chatbot inicializado!');
                    },
                    onError: (error) => {
                        console.error('‚ùå ERRO no Coze SDK:', error);
                        alert('Erro ao carregar o chatbot: ' + error.message);
                    }
                });
            } catch (error) {
                console.error('üö® FALHA CR√çTICA: N√£o foi poss√≠vel instanciar o CozeWebSDK.', error);
                alert('Falha cr√≠tica. Verifique se o script principal do Coze carregou corretamente.');
            }
        });
    </script>
</body>
</html>
